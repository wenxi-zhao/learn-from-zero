import{z as O,y as S,J as q,i as m,I as y,aa as A,ab as b,ac as I,ad as L,o as V,k as $,m as E}from"./7OvbDS87.js";import{p as T,k}from"./C-v3KzvZ.js";import{f as z,h as F}from"./BGMNvqfX.js";import{f as K}from"./Dnd51l0P.js";import{u as P}from"./BNqrt9_p.js";const _=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","label","legend","li","link","main","map","mark","math","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rb","rp","rt","rtc","ruby","s","samp","script","section","select","slot","small","source","span","strong","style","sub","summary","sup","svg","table","tbody","td","template","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr"],v="default",w=/^@|^v-on:/,B=/^:|^v-bind:/,R=/^v-model/,U=["select","textarea","input"],W=Object.fromEntries(["p","a","blockquote","code","pre","code","em","h1","h2","h3","h4","h5","h6","hr","img","ul","ol","li","strong","table","thead","tbody","td","th","tr","script"].map(t=>[t,`prose-${t}`])),J=O({name:"MDCRenderer",props:{body:{type:Object,required:!0},data:{type:Object,default:()=>({})},class:{type:[String,Object],default:void 0},tag:{type:[String,Boolean],default:void 0},prose:{type:Boolean,default:void 0},components:{type:Object,default:()=>({})},unwrap:{type:[Boolean,String],default:!1}},async setup(t){var c,a,i,l,p,u,f,C;const e=(i=(a=(c=S())==null?void 0:c.appContext)==null?void 0:a.app)==null?void 0:i.$nuxt,n=(e==null?void 0:e.$route)||(e==null?void 0:e._route),{mdc:r}=((l=e==null?void 0:e.$config)==null?void 0:l.public)||{},o={...(p=r==null?void 0:r.components)!=null&&p.prose&&t.prose!==!1?W:{},...((u=r==null?void 0:r.components)==null?void 0:u.map)||{},...q(((C=(f=t.data)==null?void 0:f.mdc)==null?void 0:C.components)||{}),...t.components},s=m(()=>{var x;const N=(((x=t.body)==null?void 0:x.children)||[]).map(d=>d.tag||d.type).filter(d=>!_.includes(d));return Array.from(new Set(N)).sort().join(".")});return await rt(t.body,{tags:o}),{tags:o,contentKey:s,route:n}},render(t){var u,f;const{tags:e,tag:n,body:r,data:o,contentKey:s,route:c,unwrap:a}=t;if(!r)return null;const i={...o,tags:e,$route:c},l=n!==!1?j(n||((u=i.component)==null?void 0:u.name)||i.component||"div"):void 0;return l?y(l,{...(f=i.component)==null?void 0:f.props,class:t.class,...this.$attrs,key:s},{default:p}):p==null?void 0:p();function p(){return a?K(h(r,y,i,i).default(),typeof a=="string"?a.split(" "):["*"]):h(r,y,i,i).default()}}});function G(t,e,n,r={}){if(t.type==="text")return e(b,t.value);if(t.type==="comment")return e(I,null,t.value);const o=t.tag,s=D(t,n.tags);if(t.tag==="binding")return H(t,e,n,r);const c=j(s);typeof c=="object"&&(c.tag=o);const a=M(t,n);return e(c,a,h(t,e,n,{...r,...a}))}function H(t,e,n,r={}){var l,p;const o={...r,$document:n,$doc:n},s=/\.|\[(\d+)\]/,a=((l=t.props)==null?void 0:l.value.trim().split(s).filter(Boolean)).reduce((u,f)=>{if(u&&f in u)return typeof u[f]=="function"?u[f]():u[f]},o),i=(p=t.props)==null?void 0:p.defaultValue;return e(b,a??i??"")}function h(t,e,n,r){const s=(t.children||[]).reduce((a,i)=>{if(!et(i))return a[v].push(i),a;const l=tt(i);return a[l]=a[l]||[],i.type==="element"&&a[l].push(...i.children||[]),a},{[v]:[]});return Object.entries(s).reduce((a,[i,l])=>(l.length&&(a[i]=()=>{const p=l.map(u=>G(u,e,n,r));return nt(p)}),a),{})}function M(t,e){const{tag:n="",props:r={}}=t;return Object.keys(r).reduce(function(o,s){if(s==="__ignoreMap")return o;const c=r[s];if(R.test(s)&&!U.includes(n))return Q(s,c,o,e);if(s==="v-bind")return X(s,c,o,e);if(w.test(s))return Y(s,c,o,e);if(B.test(s))return Z(s,c,o,e);const{attribute:a}=z(F,s);return Array.isArray(c)&&c.every(i=>typeof i=="string")?(o[a]=c.join(" "),o):(o[a]=c,o)},{})}function Q(t,e,n,r){const o=u=>+u,s=u=>u.trim(),c=u=>u,a=t.replace(R,"").split(".").filter(u=>u).reduce((u,f)=>(u[f]=!0,u),{}),i="value",l=a.lazy?"change":"input",p=a.number?o:a.trim?s:c;return n[i]=g(e,r),n.on=n.on||{},n.on[l]=u=>r[e]=p(u),n}function X(t,e,n,r){const o=g(e,r);return n=Object.assign(n,o),n}function Y(t,e,n,r){return t=t.replace(w,""),n.on=n.on||{},n.on[t]=()=>g(e,r),n}function Z(t,e,n,r){return t=t.replace(B,""),n[t]=g(e,r),n}const j=t=>{if(!_.includes(t)&&!(t!=null&&t.render)&&!(t!=null&&t.ssrRender)){const e=A(T(t),!1);if(typeof e=="object")return e}return t};function g(t,e){const n=t.split(".").reduce((r,o)=>typeof r=="object"?r[o]:void 0,e);return typeof n>"u"?L(t):n}function tt(t){let e="";for(const n of Object.keys(t.props||{}))if(!(!n.startsWith("#")&&!n.startsWith("v-slot:"))){e=n.split(/[:#]/,2)[1];break}return e||v}function et(t){return t.tag==="template"}function nt(t){const e=[];for(const n of t){const r=e[e.length-1];n.type===b&&(r==null?void 0:r.type)===b?r.children=r.children+n.children:e.push(n)}return e}async function rt(t,e){if(!t)return;const n=Array.from(new Set(r(t,e)));await Promise.all(n.map(async o=>{if(o!=null&&o.render||o!=null&&o.ssrRender||o!=null&&o.__ssrInlineRender)return;const s=j(o);s!=null&&s.__asyncLoader&&!s.__asyncResolved&&await s.__asyncLoader()}));function r(o,s){const c=o.tag;if(o.type==="text"||c==="binding"||o.type==="comment")return[];const a=D(o,s.tags),i=[];o.type!=="root"&&!_.includes(a)&&i.push(a);for(const l of o.children||[])i.push(...r(l,s));return i}}function D(t,e){var r;const n=t.tag;return!n||typeof((r=t.props)==null?void 0:r.__ignoreMap)<"u"?n:e[n]||e[T(n)]||e[k(t.tag)]||n}const ut=O({__name:"ContentRendererMarkdown",props:{value:{type:Object,required:!0},excerpt:{type:Boolean,default:!1},tag:{type:String,default:"div"},components:{type:Object,default:()=>({})},data:{type:Object,default:()=>({})}},setup(t){const e=t,n=P().isEnabled(),r=m(()=>{let c=e.value.body||e.value;return e.excerpt&&e.value.excerpt&&(c=e.value.excerpt),c}),o=m(()=>{const{body:c,excerpt:a,...i}=e.value;return{...i,...e.data}}),s=m(()=>({...e.components,...o.value._components||{}}));return(c,a)=>{const i=J;return V(),$(i,{body:r.value,data:o.value,tag:t.tag,components:s.value,"data-content-id":E(n)?t.value._id:void 0},null,8,["body","data","tag","components","data-content-id"])}}});export{ut as _};
